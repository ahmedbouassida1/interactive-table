<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrice des Privilèges et Accès des Acteurs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'DM Sans', sans-serif;
            background-color: #f9fafb; /* bg-gray-50 */
        }
        /* Updated styles for active tabs to match the new design */
        .tab-active {
            background-color: #4338ca; /* indigo-700 */
            color: white;
        }
        .sub-tab-active {
            border-bottom: 2px solid #4f46e5; /* indigo-600 */
            color: #4f46e5; /* indigo-600 */
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">
    <div id="privilege-matrix" class="max-w-5xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
        <div class="p-6 sm:p-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-700 mb-2">Tableau des Privilèges et Accès</h1>
            <p class="text-gray-500">Naviguez entre les acteurs et les plateformes pour voir les permissions.</p>
        </div>

        <!-- Main Actor Tabs -->
        <div class="px-6 sm:px-8 border-b border-gray-200">
            <nav id="main-tabs" class="flex flex-wrap -mb-px" aria-label="Tabs">
                <!-- Actor tabs will be inserted here by JavaScript -->
            </nav>
        </div>

        <!-- Content Area -->
        <div id="tab-content" class="p-6 sm:p-8">
            <!-- Actor-specific content will be rendered here -->
        </div>
    </div>

    <script>
        // Data structure for actors and their permissions (no changes to data)
        const actors = {
            "ANME": {
                web: [
                    { feature: "Gestion des Utilisateurs", access: true },
                    { feature: "Planification Interventions", access: true },
                    { feature: "Attribuer des interventions", access: true },
                    { feature: "Authentification (Web)", access: false },
                    { feature: "Visualisation Géolocalisée Appareils", access: false },
                    { feature: "Supervision Interventions", access: false },
                ],
                mobile: [
                    { feature: "Authentification (Mobile)", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Enregistrement Appareils", access: true },
                    { feature: "Consultation Actualités", access: false },
                ]
            },
            "Usine": {
                web: [
                    { feature: "Gestion des Utilisateurs", access: true },
                    { feature: "Planification Interventions", access: true },
                    { feature: "Supervision Interventions", access: true },
                    { feature: "Consultation Historique Interventions", access: true },
                    { feature: "Création/Approbation Actualités", access: true },
                    { feature: "Consultation Actualités", access: true },
                ],
                mobile: [
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Authentification (Mobile)", access: false },
                    { feature: "Notifications & Alertes", access: false },
                ]
            },
            "Administrateur Système": {
                web: [
                    { feature: "Reporting Avancé", access: true },
                    { feature: "Générateur d'Actualités IA", access: true },
                    { feature: "Authentification (Web)", access: false },
                    { feature: "Gestion des Utilisateurs", access: false },
                ],
                mobile: [
                    { feature: "Authentification (Mobile)", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Enregistrement Appareils", access: true },
                ]
            },
            "Installateur Agréé": {
                web: [
                    { feature: "Authentification (Web)", access: true },
                    { feature: "Visualisation Géolocalisée Appareils", access: true },
                    { feature: "Planification Interventions", access: true },
                    { feature: "Supervision Interventions", access: true },
                    { feature: "Consultation Historique Interventions", access: true },
                    { feature: "Export Rapports Interventions", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Création/Approbation Actualités", access: true },
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Reporting Avancé", access: true },
                ],
                mobile: [
                    { feature: "Authentification (Mobile)", access: true },
                    { feature: "Exécution Interventions", access: true },
                    { feature: "Suivi détaillé Interventions", access: true },
                    { feature: "Scan de QR Code", access: true },
                    { feature: "Consultation Historique Interventions", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Assistant de Diagnostic IA", access: true },
                    { feature: "Déclaration des Ventes", access: true },
                ]
            },
            "Réparateur Agréé": {
                web: [
                    { feature: "Authentification (Web)", access: true },
                    { feature: "Visualisation Géolocalisée Appareils", access: true },
                    { feature: "Planification Interventions", access: true },
                    { feature: "Supervision Interventions", access: true },
                    { feature: "Consultation Historique Interventions", access: true },
                    { feature: "Export Rapports Interventions", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Création/Approbation Actualités", access: true },
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Reporting Avancé", access: true },
                ],
                mobile: [
                    { feature: "Authentification (Mobile)", access: true },
                    { feature: "Exécution Interventions", access: true },
                    { feature: "Suivi détaillé Interventions", access: true },
                    { feature: "Scan de QR Code", access: true },
                    { feature: "Consultation Historique Interventions", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Assistant de Diagnostic IA", access: true },
                    { feature: "Déclaration des Ventes", access: false },
                ]
            },
            "Technicien de Maintenance": {
                web: [], // No specific web access mentioned in the doc for this role
                mobile: [
                    { feature: "Authentification (Mobile)", access: true },
                    { feature: "Exécution Interventions", access: true },
                    { feature: "Suivi détaillé Interventions", access: true },
                    { feature: "Scan de QR Code", access: true },
                    { feature: "Consultation Historique Interventions", access: true },
                    { feature: "Notifications & Alertes", access: true },
                    { feature: "Consultation Actualités", access: true },
                    { feature: "Visualisation Facteurs Environnementaux", access: true },
                    { feature: "Assistant de Diagnostic IA", access: true },
                    { feature: "Déclaration des Ventes", access: false },
                ]
            }
        };

        const mainTabsContainer = document.getElementById('main-tabs');
        const contentContainer = document.getElementById('tab-content');
        let activeActor = Object.keys(actors)[0];
        let activePlatform = 'web';

        // Function to render the content based on active tabs
        function renderContent() {
            const actorData = actors[activeActor];
            
            // Generate sub-tabs (Web/Mobile)
            const subTabsHTML = `
                <div class="border-b border-gray-200 mb-6">
                    <nav class="flex space-x-4" aria-label="Sub-tabs">
                        <button onclick="setPlatform('web')" class="sub-tab ${activePlatform === 'web' ? 'sub-tab-active' : 'text-gray-500 hover:text-gray-700'} px-3 py-2 font-medium text-sm rounded-t-md">Web</button>
                        <button onclick="setPlatform('mobile')" class="sub-tab ${activePlatform === 'mobile' ? 'sub-tab-active' : 'text-gray-500 hover:text-gray-700'} px-3 py-2 font-medium text-sm rounded-t-md">Mobile</button>
                    </nav>
                </div>
            `;

            const platformData = actorData[activePlatform];

            // Generate table for the selected platform
            let tableHTML = '<p class="text-gray-500">Aucune fonctionnalité pour cette plateforme.</p>';
            if (platformData && platformData.length > 0) {
                tableHTML = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead class="bg-indigo-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-indigo-800 uppercase tracking-wider">Fonctionnalité</th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-indigo-800 uppercase tracking-wider">Accès</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                ${platformData.map(item => `
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800">${item.feature}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-center">
                                            ${item.access 
                                                ? '<span class="text-green-600 font-bold text-xl">✓</span>' 
                                                : '<span class="text-red-500 font-bold text-xl">✗</span>'}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            contentContainer.innerHTML = subTabsHTML + tableHTML;
            renderMainTabs();
        }
        
        // Function to render the main actor tabs
        function renderMainTabs() {
            mainTabsContainer.innerHTML = Object.keys(actors).map(actorName => `
                <button onclick="setActor('${actorName}')" class="main-tab ${activeActor === actorName ? 'tab-active' : 'text-gray-600 hover:bg-gray-100'} text-sm font-medium text-center py-3 px-4 rounded-t-lg transition-colors duration-200">
                    ${actorName.replace(/_/g, ' ')}
                </button>
            `).join('');
        }

        // Functions to update state and re-render
        window.setActor = function(actorName) {
            activeActor = actorName;
            activePlatform = 'web'; 
            renderContent();
        }

        window.setPlatform = function(platformName) {
            activePlatform = platformName;
            renderContent();
        }

        // Initial render
        renderContent();
    </script>
</body>
</html>
